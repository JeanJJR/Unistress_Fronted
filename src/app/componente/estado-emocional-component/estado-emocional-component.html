<div class="main-content">
  <h2 class="page-title">Estado Emocional</h2>

  <!-- Registro Diario -->
  <mat-card class="registro-diario">
    <mat-card-header>
      <mat-card-title>Registro Diario</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <div class="emocion-nivel-container">
        <!-- Emociones -->
        <div class="emocion-seccion">
          <p>Â¿CÃ³mo te sientes hoy?</p>
          <div class="emojis">
            <button
              mat-raised-button
              (click)="emocionSeleccionada = 'feliz'"
              [class.selected]="emocionSeleccionada === 'feliz'"
            >ğŸ˜Š</button>
            <button
              mat-raised-button
              (click)="emocionSeleccionada = 'triste'"
              [class.selected]="emocionSeleccionada === 'triste'"
            >ğŸ˜¢</button>
            <button
              mat-raised-button
              (click)="emocionSeleccionada = 'enojado'"
              [class.selected]="emocionSeleccionada === 'enojado'"
            >ğŸ˜ </button>
            <button
              mat-raised-button
              (click)="emocionSeleccionada = 'ansioso'"
              [class.selected]="emocionSeleccionada === 'ansioso'"
            >ğŸ˜Ÿ</button>
            <button
              mat-raised-button
              (click)="emocionSeleccionada = 'neutral'"
              [class.selected]="emocionSeleccionada === 'neutral'"
            >ğŸ˜</button>
          </div>
        </div>

        <!-- Nivel -->
        <div class="nivel-seccion">
          <label>Nivel (1â€“10):</label>
          <mat-slider min="1" max="10" step="1" thumbLabel>
            <input matSliderThumb [(ngModel)]="nivel" />
          </mat-slider>

          <span class="nivel-valor">{{ nivel }}</span>
        </div>
      </div>

      <div class="comentario">
        <mat-form-field appearance="outline" style="width: 100%;">
          <mat-label>DescripciÃ³n</mat-label>
          <textarea
            matInput
            [(ngModel)]="comentario"
            placeholder="Escribe cÃ³mo te sientes..."
            rows="3"
          ></textarea>
        </mat-form-field>
      </div>

      <button mat-raised-button color="primary" class="btn-primary" (click)="guardarEmocion()">
        Registrar emociÃ³n
      </button>
    </mat-card-content>
  </mat-card>

  <!-- Historial -->
  <mat-card class="historial-emociones">
    <mat-card-header>
      <mat-card-title>Historial de emociones</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <table mat-table [dataSource]="historial" class="emociones-table">

        <!-- Fecha Column -->
        <ng-container matColumnDef="fecha">
          <th mat-header-cell *matHeaderCellDef>Fecha</th>
          <td mat-cell *matCellDef="let item">
            {{ esHoy(item.fechaRegistro) ? 'Hoy' : (item.fechaRegistro | date:'yyyy-MM-dd') }}
          </td>
        </ng-container>

        <!-- EmociÃ³n Column -->
        <ng-container matColumnDef="emocion">
          <th mat-header-cell *matHeaderCellDef>EmociÃ³n</th>
          <td mat-cell *matCellDef="let item">
            <span *ngIf="item.emocion === 'feliz'">ğŸ˜Š</span>
            <span *ngIf="item.emocion === 'triste'">ğŸ˜¢</span>
            <span *ngIf="item.emocion === 'enojado'">ğŸ˜ </span>
            <span *ngIf="item.emocion === 'ansioso'">ğŸ˜Ÿ</span>
            <span *ngIf="item.emocion === 'neutral'">ğŸ˜</span>
          </td>
        </ng-container>

        <!-- Nivel Column -->
        <ng-container matColumnDef="nivel">
          <th mat-header-cell *matHeaderCellDef>Nivel</th>
          <td mat-cell *matCellDef="let item">{{ item.nivel }}/10</td>
        </ng-container>

        <!-- DescripciÃ³n Column -->
        <ng-container matColumnDef="descripcion">
          <th mat-header-cell *matHeaderCellDef>DescripciÃ³n</th>
          <td mat-cell *matCellDef="let item">{{ item.descripcion }}</td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>

        <!-- Sin datos -->
        <tr *ngIf="historial.length === 0">
          <td class="empty" colspan="4">No hay registros</td>
        </tr>
      </table>
    </mat-card-content>
  </mat-card>
</div>
